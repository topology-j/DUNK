                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                // DOM(Document Object Model)  
$(document).ready(function() {
	

	//       
	$("#replyWrite").on("click", function() {
		
		//    
		console.log($("#replyForm").css("display"));
		console.log($("#replyForm").is(":visible"));
		
		//      
		if($("#replyForm").is(":visible")) {
			
			/*          
			 *           
			 *   0.3    . 
			 **/
			var $prev = $("#replyTitle").prev();
			if(! $prev.is("#replyForm")) {
				$("#replyForm").slideUp(300);
			}
			setTimeout(function(){
				$("#replyForm").insertBefore("#replyTitle").slideDown(300);
			}, 300);	
					
		} else {	//      		
			$("#replyForm").removeClass("d-none")
				.css("display", "none").insertBefore("#replyTitle").slideDown(300);			
		}
		
		/*            id
		 *            
		 * data-no   .
		 **/
		$("#replyForm").find("form")
			.attr("id", "replyWriteForm").removeAttr("data-no");
		$("#replyContent").val("");
		$("#replyWriteButton").val("");
		
	});
	
		
	/*    submit  
	 *     html       
	 *   ajax       
	 *         delegate 
	 *   .  ,     
	 *       html 
	 *          .
	 *     delegate    .
	 **/
	$(document).on("submit", "#replyWriteForm", function(e) {
 		 	
 		if($("#replyContent").val().length < 5) {
 			alert(" 5   .");
 			return false;
 		}
 
 		var params = $(this).serialize();
 		console.log(params);	
 		
 		$.ajax({
 			"url": "placeReplyAddProcess.ajax",
 			"data": params,
 			"type": "post",
 			"dataType": "json",
 			"success": function(resData) {
 				console.log(resData);
 				
 				//   - html  
 				$("#replyList").empty(); 			
 				$.each(resData, function(i, v) {
 				
 					// v.regData == 1672300816000
 					var date = new Date(v.regDate);
 					var strDate = date.getFullYear() + "-" + ((date.getMonth() + 1 < 10) 
 								? "0" + (date.getMonth() + 1) : (date.getMonth() + 1)) + "-"
 								+ (date.getDate() < 10 ? "0" + date.getDate() : date.getDate()) +  " " 
 								+ (date.getHours() < 10 ? "0" + date.getHours() : date.getHours()) + ":"
 								+ (date.getMinutes() < 10 ? "0" + date.getMinutes() : date.getMinutes()) + ":"
 								+ (date.getSeconds() < 10 ? "0" + date.getSeconds() : date.getSeconds());
 					 
	 				var result = 
	 					'<div class="row border border-top-0 replyRow">'
						+ '<div class="col">'
						+ '	<div class="row bg-light p-2">'									
						+ '		<div class="col-4">'						
						+ '			<span>' + v.userId + '</span>'
						+ '		</div>'
						+ '		<div class="col-8 text-end">'
						+ '			<span class="me-3">' + strDate + "</span>"
						+ '			<button class="modifyReply btn btn-outline-success btn-sm" data-no="' + v.no + '">'
						+ '				<i class="bi bi-journal-text"></i>'								
						+ '			</button>'
						+ '			<button class="deleteReply btn btn-outline-warning btn-sm" data-no="' + v.no + '">'
						+ '				<i class="bi bi-trash"></i>'	
						+ '			</button>'
						+ '			<button class="btn btn-outline-danger btn-sm" onclick="reportReply(\'' + v.no + '\')">'
						+ '				<i class="bi bi-telephone-outbound"></i>'								
						+ '			</button>'
						+ '		</div>'
						+ '	</div>'
						+ ' 	<div class="row">'						
						+ '		<div class="col p-3">'
						+ '			<pre>' + v.replyContent + '</pre>'
						+ '		</div>'
						+ ' 	</div>'
						+ '</div>'
					+ '</div>'
	 					 				
	 				$("#replyList").append(result);
	 				$("#replyList").removeClass("text-center");
	 				$("#replyList").removeClass("p-5");
 				 				
 				}); // end $.each()				
 				
 				//     .
 				$("#replyForm").slideUp(300)
 					.add("#replyContent").val(""); 				
 			},
 			"error": function(xhr, status) {
 				console.log("error : " + status);
 			}
 		});
	
		//   
		return false;
 	});
		
		
	/*    
	 *        delegate  
	 *  .  $(".modifyReply").click(function() {});  
	 *    ,      
	 *       delegate    .
	 **/
	$(document).on("click", ".modifyReply", function() {
				
		//    
		console.log($("#replyForm").css("display"));
		console.log($("#replyForm").is(":visible"));
		
		//      .
		console.log($(this).parents(".replyRow"));
		var $replyRow = $(this).parents(".replyRow");
		
		//      
		if($("#replyForm").is(":visible")) {
			
			/*          
			 *           
			 *     0.3    . 
			 **/
			var $next = $replyRow.next();
			if(! $next.is("#replyForm")) {
				$("#replyForm").slideUp(300);
			}
			setTimeout(function(){
				$("#replyForm").insertAfter($replyRow).slideDown(300);
			}, 300);	
					
		} else { //       			
			$("#replyForm").removeClass("d-none")
				.css("display", "none").insertAfter($replyRow).slideDown(300);			
		}
		
		/*            id
		 *            
		 * data-no   .
		 **/
		$("#replyForm").find("form")
			.attr({"id": "replyUpdateForm", "data-no": $(this).attr("data-no") });		
		$("#replyWriteButton").val("");
		
		//            .
		var reply = $(this).parent().parent().next().find("pre").text();
		$("#replyContent").val($.trim(reply));
				
	});
		
		
	//    submit  	 
	$(document).on("submit", "#replyUpdateForm", function() {	
	//$("#replyUpdateForm").on("submit", function() {	
	
		if($("#replyContent").val().length <= 5) {
			alert(" 5   .");
			// Ajax  .
			return false;
		}
 				
		/*  $("#replyTable").empty();  
		 *          .
		 **/				
		$replyForm = $("#replyForm").slideUp(300);
		
		/* replyNo      .
		 *           
		 *       .  
		 *           . 
		 **/
		var params = $(this).serialize() + "&no=" + $(this).attr("data-no");
		console.log(params);
				
		$.ajax({
			url: "placeReplyUpdateProcess.ajax",
			type: "post",
			data: params,
			dataType: "json",
			success: function(resData, status, xhr) {								
	
				console.log(resData);
 				
 				//   - html  
 				$("#replyList").empty();
 				$.each(resData, function(i, v) {
 				
 					// v.regData == 1672300816000
 					var date = new Date(v.regDate);
 					var strDate = date.getFullYear() + "-" + ((date.getMonth() + 1 < 10) 
 								? "0" + (date.getMonth() + 1) : (date.getMonth() + 1)) + "-"
 								+ (date.getDate() < 10 ? "0" + date.getDate() : date.getDate()) +  " " 
 								+ (date.getHours() < 10 ? "0" + date.getHours() : date.getHours()) + ":"
 								+ (date.getMinutes() < 10 ? "0" + date.getMinutes() : date.getMinutes()) + ":"
 								+ (date.getSeconds() < 10 ? "0" + date.getSeconds() : date.getSeconds());
 					 
	 				var result = 
	 					'<div class="row border border-top-0 replyRow">'
						+ '<div class="col">'
						+ '	<div class="row bg-light p-2">'									
						+ '		<div class="col-4">'						
						+ '			<span>' + v.userId + '</span>'
						+ '		</div>'
						+ '		<div class="col-8 text-end">'
						+ '			<span class="me-3">' + strDate + "</span>"
						+ '			<button class="modifyReply btn btn-outline-success btn-sm" data-no="' + v.no + '">'
						+ '				<i class="bi bi-journal-text"></i>'								
						+ '			</button>'
						+ '			<button class="deleteReply btn btn-outline-warning btn-sm" data-no="' + v.no + '">'
						+ '				<i class="bi bi-trash"></i>'	
						+ '			</button>'
						+ '			<button class="btn btn-outline-danger btn-sm" onclick="reportReply(\'' + v.no + '\')">'
						+ '				<i class="bi bi-telephone-outbound"></i>'								
						+ '			</button>'
						+ '		</div>'
						+ '	</div>'
						+ ' 	<div class="row">'						
						+ '		<div class="col p-3">'
						+ '			<pre>' + v.replyContent + '</pre>'
						+ '		</div>'
						+ ' 	</div>'
						+ '</div>'
					+ '</div>'
	 					 				
	 				$("#replyList").append(result);
 				 				
 				}); // end $.each()
 				
 				//     .
 				$("#replyContent").val("");
 				$replyForm.css("display", "none"); 				
 				$("#global-content > div.col").append($replyForm);
 				
			},
			error: function(xhr, status, error) {
				alert("ajax  : " + status + " - " + xhr.status);
			}
			
		});
		
		//  submit   .
		return false;
	});


	/*    
	 *        delegate  
	 *   .  $(".deleteReply").click(function() {});    
	 *            
	 *    delegate    .
	 **/
	$(document).on("click", ".deleteReply", function() {	
		
		var no = $(this).attr("data-no");
		var writer = $(this).parent().prev().find("span").text();
		var bbsNo = $("#replyForm input[name=no]").val();
		var params = "no=" + no;	
		console.log(params);
		
		/*  $("#replyTable").empty();  
		 *          .
		 **/				
		$replyForm = $("#replyForm").slideUp(300);
		
		var result = confirm(writer + "  " + no +"  ?");
		
		if(result) {
			$.ajax({
				url: "placeReplyDeleteProcess.ajax",
				type: "post",
				data: params,
				dataType: "json",
				success: function(resData, status, xhr) {			
					
					console.log(resData);
	 				
	 				//   - html  
	 				$("#replyList").empty();
	 				
	 				$.each(resData, function(i, v) {
	 				
	 					// v.regData == 1672300816000
	 					var date = new Date(v.regDate);
	 					var strDate = date.getFullYear() + "-" + ((date.getMonth() + 1 < 10) 
	 								? "0" + (date.getMonth() + 1) : (date.getMonth() + 1)) + "-"
	 								+ (date.getDate() < 10 ? "0" + date.getDate() : date.getDate()) +  " " 
	 								+ (date.getHours() < 10 ? "0" + date.getHours() : date.getHours()) + ":"
	 								+ (date.getMinutes() < 10 ? "0" + date.getMinutes() : date.getMinutes()) + ":"
	 								+ (date.getSeconds() < 10 ? "0" + date.getSeconds() : date.getSeconds());
	 					 
		 				var result = 
		 					'<div class="row border border-top-0 replyRow">'
							+ '<div class="col">'
							+ '	<div class="row bg-light p-2">'									
							+ '		<div class="col-4">'						
							+ '			<span>' + v.userId + '</span>'
							+ '		</div>'
							+ '		<div class="col-8 text-end">'
							+ '			<span class="me-3">' + strDate + "</span>"
							+ '			<button class="modifyReply btn btn-outline-success btn-sm" data-no="' + v.no + '">'
							+ '				<i class="bi bi-journal-text"></i>'								
							+ '			</button>'
							+ '			<button class="deleteReply btn btn-outline-warning btn-sm" data-no="' + v.no + '">'
							+ '				<i class="bi bi-trash"></i>'	
							+ '			</button>'
							+ '			<button class="btn btn-outline-danger btn-sm" onclick="reportReply(\'' + v.no + '\')">'
							+ '				<i class="bi bi-telephone-outbound"></i>'								
							+ '			</button>'
							+ '		</div>'
							+ '	</div>'
							+ ' 	<div class="row">'						
							+ '		<div class="col p-3">'
							+ '			<pre>' + v.replyContent + '</pre>'
							+ '		</div>'
							+ ' 	</div>'
							+ '</div>'
						+ '</div>'
		 					 				
		 				$("#replyList").append(result);
	 				 				
	 				}); // end $.each()
	 				
	 				//     .
	 				$("#replyContent").val("");
	 				$replyForm.css("display", "none"); 				
	 				$("#global-content > div.col").append($replyForm);
	 				
				},
				error: function(xhr, status, error) {
					alert("ajax  : " + status + " - " + xhr.status);
				}
			});
		}
		//       .
		return false;
	});	
});

/*       */
function reportReply(elemId) {
	var result = confirm("  ?");
	if(result == true) {
		alert("report - " + result);
	}	
}